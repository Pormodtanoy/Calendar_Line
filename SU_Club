‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï : https://www.youtube.com/c/MakkhawinKunpomm
//‡∏û‡∏±‡∏í‡∏ô‡∏≤ : ‡∏û‡πà‡∏≠‡∏°‡∏î‡∏ï‡∏∞‡∏ô‡∏≠‡∏¢*//

function dailyAll() {
  dailyEventMessage(1) //‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
}

function dailyEvent() {
  dailyEventMessage(2) //‡∏ï‡∏≤‡∏°‡πÄ‡∏ß‡∏•‡∏≤
}  
  
function dailyEventMessage(IDShow) {
  var googleCalendarId = "11111111111";
  
  var calendar = CalendarApp.getCalendarById(googleCalendarId);
  var today = new Date();
  var dailyEventList = calendar.getEventsForDay(today);
  dailyEventList[0].get
  var strWeek = ["‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå", "‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå", "‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£", "‡∏û‡∏∏‡∏ò", "‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ", "‡∏®‡∏∏‡∏Å‡∏£‡πå", "‡πÄ‡∏™‡∏≤‡∏£‡πå"]; //‡∏ü‡∏±‡∏á‡∏ä‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏´‡∏≤‡∏ß‡∏±‡∏ô‡πÉ‡∏ô‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå
  var strMonthFull = ["‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°", "‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå", "‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°", "‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô", "‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°", "‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô", "‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°", "‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°", "‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô", "‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°", "‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô", "‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°"]; //‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô

  //var  d = new Date(); //‡∏Å‡∏≥‡∏´‡∏ô‡∏î d ‡πÄ‡∏Å‡πá‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ
  var curdate=today.getDate(); // ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1-31
  var daycur = today.getDay(); // ‡∏ß‡∏±‡∏ô 0-6 ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏õ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ß‡∏±‡∏ô ‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå-‡∏®‡∏∏‡∏Å‡∏£‡πå
  var monthcur=today.getMonth();  //‡πÄ‡∏•‡∏Ç‡πÄ‡∏î‡∏∑‡∏≠‡∏ô 0-11 ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏õ‡∏´‡∏≤ ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°-‡∏ò‡∏±‡∏ß‡∏≤‡∏Ñ‡∏°
  var yearcur =today.getFullYear()+543; //‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏µ ‡∏Ñ.‡∏®. ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô ‡∏û.‡∏®.
  var yearEng =today.getFullYear(); //‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏µ ‡∏Ñ.‡∏®. ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô ‡∏û.‡∏®.  
  var MonthId = strMonthFull[monthcur]; //‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢ ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°-‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°
  var Day_List = strWeek[daycur]; //‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå
  
  var strhour=Utilities.formatDate(new Date(), "Asia/Bangkok", "HH");  // HH 
  var strMinute=Utilities.formatDate(new Date(), "Asia/Bangkok", "mm"); //m ‡∏Å‡∏±‡∏ö mm 
  var HourMintue=strhour+':'+strMinute;    

  var DayShow=''+Day_List+' ‡∏ó‡∏µ‡πà '+ curdate+''+MonthId+' ‡∏û.‡∏®. '+yearcur 
  
  var messageAll =DayShow;
  
  for (var i = 0; i < dailyEventList.length; i++) {
  
    var eventTitle =   "üìö‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á : "  + dailyEventList[i].getTitle();
    var eventTime  =   "‚åö‡πÄ‡∏ß‡∏•‡∏≤ : " + "" + dailyEventList[i].getStartTime().toTimeString().slice(0,8);
    var eventDescription = "üéØ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î " + "\n" + dailyEventList[i].getDescription();
    
    var DailyHM=dailyEventList[i].getStartTime().toTimeString().slice(0,5);

    messageAll += "\n" + eventTitle + "\n" + eventTime + "\n" + eventDescription;
    
    if (IDShow==2){ //‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏à‡πâ‡∏á‡∏ï‡∏≤‡∏°‡πÄ‡∏ß‡∏•‡∏≤        
        if (DailyHM==HourMintue){
          var message =DayShow+''+eventTitle + "\n" + eventTime + "\n" + eventDescription;  
          if (message !== "") {
            //Logger.log(message);  
            sendMessage(message);    
          }//if
        } //if
    } //if  
  } //for
  
  if (IDShow==1){ //‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
    if (messageAll !== "") {
      //Logger.log(messageAll);  
      sendMessage(messageAll);    
    }
  }  
} //func


function sendMessage(message) {
  var lineNotifyEndPoint = "https://notify-api.line.me/api/notify";
  var accessToken = "22222222222";
  
  var formData = {
    "message": message
  };
  
  var options = {
    "headers" : {"Authorization" : "Bearer " + accessToken},
    "method" : 'post',
    "payload" : formData
  };

  try {
    var response = UrlFetchApp.fetch(lineNotifyEndPoint, options);
  }
  catch (error) {
    Logger.log(error.name + "Ôºö" + error.message);
    return;
  }
    
  if (response.getResponseCode() !== 200) {
    Logger.log("Sending message failed.");
  } 
}
